---
import Carrito from "./Icon/Carrito.astro"
import Search from "./Icon/Search.astro"
import User from "./Icon/User.astro"
---
<!-- import { productos } from "../data/productos";


    const buttonSearch = document.querySelector("#btn-search")

    buttonSearch.addEventListener("click", () => {
        buscar();
    });    

    function buscar() {

        let query = (document.getElementById("search") as HTMLInputElement).value;

        console.log(query);

        if(query.trim() === ""){
            return;
        }

        let results = [];

        for(let i = 0; i < {productos.tipo}.length; i++ ){
            if(productos[i].toLowerCase().includes(query.toLowerCase())){
                results.push({productos.tipo}[i]);
            }
        }

        document.getElementById("results").innerHTML = "";

        if(results.length > 0){
            for(let i = 0; i < results.length; i++){
                let li = document.createElement("li");
                li.textContent = results[i];
                document.getElementById("results").appendChild(li);
            }
        }
        else{
            let li = document.createElement("li");
            li.textContent = "No se encontraron productos para: " + query;
            document.getElementById("results").appendChild(li);
        }
    } -->
<header
    class="fixed flex w-full justify-between px-10 h-32 items-center bg-claro border border-b-medioBajo"
    id="nav-bar"
>
    <div class="ml-2">
        <a href="/">
            <img src="/img/logo/Logo-zoe.png" alt="logo" width="180px" />
        </a>
    </div>
    <nav class="flex flex-wrap gap-14 ml-[950px] mt-10">
        <a class="hover:scale-110 transition-all text-black hover:text-medioAlto text-lg font-medium" href="/productos">Productos</a>
        <a class="hover:scale-110 transition-all text-black hover:text-medioAlto text-lg font-medium" href="/nosotros">Nosotros</a>
        <a class="hover:scale-110 transition-all text-black hover:text-medioAlto text-lg font-medium" href="/contacto">Contacto</a>
        
    </nav>
    <div class="w-1/7 max-auto mt-10 ml-4">
        <div class="relative shadow-md rounded-lg">
        <input type="text" id="search" class="rounded-lg border-medioBajo outline-none focus:border-medioAlto focus:ring-1 focus:ring-medioAlto h-8">
        <button id="btn-search" class="text-medioBajo text-lg px-2 rounded-lg absolute end-1 bottom-1 hover:text-medioAlto"><Search/></button>
        </div>
        <ul id="results"></ul>
    </div>
    <div class="w-1/7 max-auto mt-10 ml-4 hover:scale-110 transition-all"><a class="text-black transition-all hover:text-medioAlto" href="/miCompra"><Carrito/></a></div>
    <nav class="text-black mt-6 -mr-4 hover:text-medioAlto transition-all" data-id="menu" >
        <ul>
            <li class="link-parent">
                <a href="#" class="flex justify-center" data-dropdown><User/></a>
                <ul class="link-child">
                    <li class="hover:text-medioAlto">
                        <a href="#" id="open-modal">Iniciar sesi√≥n</a>
                    </li>
                    <li class="hover:text-medioAlto">
                        <a href="#" id="open-modal-user">Crear cuenta</a>
                    </li>
                </ul>
            </li>
        </ul>
    </nav>
</header>
<style>
    .sinBorde:focus{
                border: none;

    }
    #nav-bar {
        z-index: 1;
        animation: blur linear both;
        animation-timeline: scroll();
        animation-range: 0 500px;
    }
    @keyframes blur {
        to {
            color: white;
            box-shadow:
                0px 5px 50px -5px hsla(0, 0%, 100%, 0.1),
                0px 0px 0px 1px hsla(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
        }
    }

    @keyframes underlineAnimation {
        from {
            width: 0;
            opacity: 0;
        }
        to {
            width: 100%;
            opacity: 1;
        }
    }
    .underline-animated {
        position: relative;
        display: inline-block;
        text-decoration: none;
        color: black;
    }
    .underline-animated::after {
        content: "";
        position: absolute;
        left: 0;
        bottom: 0;
        height: 2px;
        background-color: currentColor;
        width: 100%;
        transform: scaleX(0);
        transition: transform 0.3s ease;
        transform-origin: bottom left;
    }
    .underline-animated:hover::after {
        transform: scaleX(1);
        transform-origin: bottom left;
    }
    .link-parent {
        @apply grid grid-rows-[max-content_0fr]
        overflow-hidden transition-[grid-template-rows]
        cursor-pointer data-[toggle]:grid-rows-[max-content_1fr];
    }
    .link-child {
        @apply overflow-hidden text-black text-sm
    }

</style>
<script>
    const navigation = document.querySelector("[data-id='menu']");

    navigation.addEventListener("click", function(e){

        const currentElement = e.target as HTMLElement;

        if(currentElement.matches('[data-dropdown],[data-dropdown] *')){
                    
            const parentLi = currentElement.closest("li");
            
            if( parentLi.matches("[data-toggle]")){
                parentLi.removeAttribute("data-toggle");
            }else{
                parentLi.setAttribute("data-toggle", "");
            }
            
        }
    });
</script>